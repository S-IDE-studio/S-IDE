name: Generate Signing Keys

on:
  workflow_dispatch:

jobs:
  generate-keys:
    runs-on: ubuntu-latest
    steps:
      - name: Generate keypair
        run: |
          # Install minisign
          wget https://github.com/jedisct1/minisign/releases/download/0.12/minisign-0.12-linux.tar.gz
          tar xzf minisign-0.12-linux.tar.gz
          # Find and use minisign binary
          MINISIGN=$(find . -name minisign -type f | head -1)
          chmod +x "$MINISIGN"

          # Generate keypair with empty password
          echo "" | "$MINISIGN" -G -s tauri.key -p tauri.pubkey -t "S-IDE Update Key"

          # Output keys (copy these to GitHub Secrets)
          echo "PRIVATE_KEY:"
          cat tauri.key | base64 -w 0
          echo ""
          echo "PUBLIC_KEY:"
          cat tauri.pubkey
          echo ""
          echo "PUBLIC_KEY_BASE64:"
          cat tauri.pubkey | base64 -w 0
